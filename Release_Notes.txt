XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
obsproc_prep release 3.0.0 --> released ??? ?, 2014

files:
 *obsproc_prep/fix/prepobs_cqc_statbge
 *obsproc_prep/fix/prepobs_landc
 *obsproc_prep/fix/prepobs_prep.bufrtable
 *obsproc_prep/fix/syndat_syndata.slmask.t126.gaussian
 *obsproc_prep/fix/syndat_weight
 *obsproc_prep/sorc/prepobs_cqcbufr.fd/cqcbufr.f
 *obsproc_prep/sorc/prepobs_cqcbufr.fd/makefile
 *obsproc_prep/sorc/prepobs_cqcbufr.fd/radcor.f
 *obsproc_prep/sorc/prepobs_cqcvad.fd/cqcvad.f
 *obsproc_prep/sorc/prepobs_cqcvad.fd/makefile
 *obsproc_prep/sorc/prepobs_listheaders.fd/listheaders.f90
 *obsproc_prep/sorc/prepobs_listheaders.fd/makefile
 *obsproc_prep/sorc/prepobs_monoprepbufr.fd/makefile
 *obsproc_prep/sorc/prepobs_monoprepbufr.fd/monoprepbufr.f90
 *obsproc_prep/sorc/prepobs_mpcopybufr.fd/makefile
 *obsproc_prep/sorc/prepobs_mpcopybufr.fd/mpcopybufr.f90
 *obsproc_prep/sorc/prepobs_oiqcbufr.fd/makefile
 *obsproc_prep/sorc/prepobs_oiqcbufr.fd/oiqcbufr.f
 *obsproc_prep/sorc/prepobs_prepacpf.fd/makefile
 *obsproc_prep/sorc/prepobs_prepacpf.fd/prepacpf.f
 *obsproc_prep/sorc/prepobs_prepacqc.fd/acftobs_qc.f
 *obsproc_prep/sorc/prepobs_prepacqc.fd/indexc40.f
 *obsproc_prep/sorc/prepobs_prepacqc.fd/input_acqc.f
 *obsproc_prep/sorc/prepobs_prepacqc.fd/makefile
 *obsproc_prep/sorc/prepobs_prepacqc.fd/output_acqc_noprof.f
 *obsproc_prep/sorc/prepobs_prepacqc.fd/output_acqc_prof.f
 *obsproc_prep/sorc/prepobs_prepacqc.fd/prepacqc.f
 *obsproc_prep/sorc/prepobs_prepacqc.fd/sub2mem_mer.f
 *obsproc_prep/sorc/prepobs_prepacqc.fd/sub2mem_um.f
 *obsproc_prep/sorc/prepobs_prepacqc.fd/tranQCflags.f
 *obsproc_prep/sorc/prepobs_prepdata.fd/inc_w3unpkb7.inc
 *obsproc_prep/sorc/prepobs_prepdata.fd/iw3unpbf.f
 *obsproc_prep/sorc/prepobs_prepdata.fd/makefile
 *obsproc_prep/sorc/prepobs_prepdata.fd/prepdata.f
 *obsproc_prep/sorc/prepobs_prepdata.fd/w3atovsunp.f
 *obsproc_prep/sorc/prepobs_prepdata.fd/w3cnvxtovs.f
 *obsproc_prep/sorc/prepobs_prepdata.fd/w3rtovsunp.f
 *obsproc_prep/sorc/prepobs_prepdata.fd/w3unpkb7.f
 *obsproc_prep/sorc/prepobs_prepdata.fd/w3tovseds.f
 *obsproc_prep/sorc/prepobs_prepdata.fd/w3tovsmnd.f
 *obsproc_prep/sorc/prepobs_prepdata.fd/wordlength.f
 *obsproc_prep/sorc/prepobs_prevents.fd/gblevents_cdas.f
 *obsproc_prep/sorc/prepobs_prevents.fd/makefile
 *obsproc_prep/sorc/prepobs_prevents.fd/prevents.f
 *obsproc_prep/sorc/prepobs_profcqc.fd/makefile
 *obsproc_prep/sorc/prepobs_profcqc.fd/profcqc.f
 *obsproc_prep/sorc/syndat_syndata.fd/makefile
 *obsproc_prep/sorc/syndat_syndata.fd/syndata.f
 *obsproc_prep/sorc/build.sh
 *obsproc_prep/sorc/clean.sh
 *obsproc_prep/sorc/install.sh
 *obsproc_prep/sorc/load_libs.rc
 *obsproc_prep/sorc/README.build
 *obsproc_prep/sorc/setlibs.rc
 *obsproc_prep/ush/prepobs_cqcbufr.sh
 *obsproc_prep/ush/prepobs_cqcvad.sh
 *obsproc_prep/ush/prepobs_makeprepbufr.sh
 *obsproc_prep/ush/prepobs_oiqcbufr.sh
 *obsproc_prep/ush/prepobs_prepacqc.sh
 *obsproc_prep/ush/prepobs_prevents.sh
 *obsproc_prep/ush/prepobs_profcqc.sh
 *obsproc_prep/ush/prepobs_syndata.sh

( * - changed)


 USH script changes:
   prepobs_makeprepbufr.sh:
    - Imports new environment variable $HOMEobsproc_prep which points to
      directory path for generic prep subdirectories under version control (in
      production this is normally /nwprod/obsproc_prep.vX.Y.Z where X.Y.Z
      version number being used, usually the latest).  This replaces
      /nw${envir}.
    - Imports new environment variable $HOMEobsproc_network which points to
      directory path for network-specific prep subdirectories under version
      control (in production this is normally /nwprod/obsproc_NETWORK.vX.Y.Z
      where NETWORK is, e.g., global, nam, rap, rtma, urma, and X.Y.Z is
      version number being used, usually the latest).  This replaces
      /nw${envir}.
    - Removed all references to RUC network (obsolete).
    - Removed all references to CDC network (obsolete).
    - Added references to URMA network.
    - Removed option to run on MACHINE=sgi - this is obsolete (as a result
      variables $MACHINE and $HOMEALL are no longer used in this script).
    - Replaced variable $EXECUTIL with $utilexec for directory path to utility
      program ndate (both were exported from job scripts with same value,
      $EXECUTIL has now been removed from all parent PREP job scripts).
   prepobs_syndata.sh:
    - Modified export variable FORT14 to point to renamed fix file:
      syndat_syndata.slmask.t126.gaussian 
   prepobs_prevents.sh
    - Removed all references to CDC network (obsolete).
    - Added references to URMA network.
   prepobs_cqcbufr.sh, prepobs_cqcvad.sh, prepobs_oiqcbufr.sh,
   prepobs_prepacqc.sh, prepobs_profcqc.sh: 
    - No changes; initial population of vertical structure. 
      
 Source code changes:
   build.sh in sorc directory:
    - New. Used to build one or all executables in the *.fd sub-directories of
      the sorc directory.  Reads either load_libs.rc or setlibs.rc file to
      point to library version numbers needed by makefiles.
   clean.sh in sorc directory:
    - New. Used to "make clean" one or more *.fd sub-directories in the sorc
      directory (generally after a build).
   install.sh in sorc directory:
    - New. Used to install (move) one or more executables (after build) in exec
      directory (assumed to be in same root directory as sorc).
   load_libs.rc in sorc directory:
    - New. Read by build.sh - contains library version numbers needed by
      makefiles.  (Not read if setlibs.rc is read.)
   README.build in sorc directory:
    - New. Documentation on using build.sh and install.sh.
   setlibs.rc in sorc directory:
    - New. Read by build.sh - contains library version numbers needed by
      makefiles.  (Not read if load_libs.rc is read.)
   prepobs_cqcbufr, prepobs_cqcvad, prepobs_listheaders, prepobs_monoprepbufr,
   prepobs_mpcopybufr, prepobs_oiqcbufr, prepobs_prepacpf, prepobs_prepacqc,
   prepobs_prepdata, prepobs_prevents, prepobs_profcqc, syndat_syndata:
    - Makefile modified to use environment variables to point to library
      version numbers and to add sample build script and info in sorc
      directory.  This generalizes the library version information.
   prepobs_cqcbufr, prepobs_listheaders, prepobs_monoprepbufr,
   prepobs_mpcopybufr, prepobs_oiqcbufr, prepobs_prepacpf, prepobs_prevents,
   prepobs_profcqc, syndat_syndata:
    - No change to source.
   prepobs_cqcvad:
    - Increased total number of levels amongst all VAD reports that can be
      processed and total number of events amongst all VAD reports that can be
      processed from 160000 to 500000.
      BENEFIT: This increase will accommodate both (Radar Coded Message) and
               Level 2 decoder VAD wind reports.
    - Generated a new dynamic variable "icntmx" (product of number of stations
      reporting (max=200), number of reporting times in the dataset time span
      (max=6), and the number of data type increments (max=3, but more
      realistically 2, u and v)) to allocate the upper limit of a multi-nested
      DO loop in subroutines INCDIST and RESIDST.  The static limit of 1000
      was occasionally being exceeded.
      BENEFIT: This change does not affect the output PREPBUFR file but it does
               improve the statistical evaluation of both legacy (Radar Coded
               Message) and Level 2 decoder VAD wind reports.
   prepobs_prepacqc:
    - In final subroutine which copies all BUFR messages from input to output
      PREPBUFR file (including aircraft reports undated by this program), moved
      BUFRLIB routine OPENMB call to after time-window and geographic-domain
      checks to prevent creation of an empty, but open, BUFR message (of type
      AIRCAR) in (rare) cases where absolutely no aircraft reports pass these
      checks
      BENEFIT: Prevents a BUFRLIB abort due to previous message being open
               when attempting to copy first non-aircraft message from input to
               output PREPBUFR file in such cases where no aircraft reports are
               written back out.  This occurred in the 07z 20140214 RAP_PREP
               production run when the number of aircraft reports was severely
               reduced due to a fiber cut and no reports survived the time-
               window check.
   prepobs_prepdata:
      prepdata:
       - Adjusted namelist switches FWINDO, JSURFM,  JSURFW, and NPKRPT (new)
         from 11 elements to 12. Added twelfth element to sfc ob type array.
         Set ITYP=12 for Coast Guard tide gauge.  Other minor changes.
         BENEFIT: Now Coast Guard tide gauge reports are available to be
                  encoded into the PREPBUFR file for all networks that process
                  the SFCSHP dump file.
       - Added namelist switch NPKRPT (12 elements, see above) which if TRUE,
         does all of the following:
            - Will process surface reports that would otherwise be tossed due
              to their having a missing pstn.
            - In order to still allow for a q calculation, these reports
              temporarily estimate pstn from the U.S. Std. Atmosphere value and
              assign it a minimum q.m. of 3 while also permanently assigning
              the moisture q.m. a minimum value of 3.  In the end, pstn obs
              ("POB") and q.m. "PQM") are encoded as missing for these reports.
            - These reports are then assigned new PREPBUFR report types 192/292
              (land SYNOP), 193/293 (land METAR), 194/294 (marine), 195/295
              (mesonet).
        !!! - ATLAS buoys (no pressure data) will be processed as before -
              POB encoded with 1013.0 (mb), TYP=282, no mass report.
        !!! - MESONETS with no reported pressure or altimeter will no longer
              have "x" in character 8 of id and U.S. Std. Atmos. as POB, but
              instead will be encoded with POB missing and TYP=195/295.
            - New switch ipstnflg will be set to 1 (defaults to zero) to
              indicate this report is being encoded with missing pressure.
         Other minor changes as well.
         BENEFIT: ADPSFC, SFCSHP, and MSONET reports that do not contain
                  station pressure information are now retained (previously,
                  they were discarded) when NPKRPT(x)=TRUE for surface ITYP=x.
                  They are now available for the analysis.
        !!!       Currently this is the case in the ..., ..., ... networks.
       - Added new mnemonic "PMIN" (mean sea-level pressure indicator) which
         is encoded with a value of zero for all reports with an observed mean
         sea-level pressure encoded in "PMO" (currently could only by land
         SYNOP or METAR). "PMIN" will be encoded with a value of 1 in w3emc
         routine GBLEVENTS for cases where a mean sea-level pressure is
         derived because it was encoded as missing in PREPBUFR file by
         prepobs_prepdata in PREP (see below and docblock in GBLEVENTS for
  !!!    more information); e.g., for all marine and mesonet reports right
  !!!    now.  (See changes #1, 4 & 5 to fix file prepobs_prep.bufrtable
         below.)  Other minor changes as well.
         BENEFIT: Downstream codes will be able to differentiate between
                  observed and derived PMO via the PMIN value.
       - Modified subroutine GETC06 to skip over PREPBUFR encoding if u- or
         v-comp of wind (m/sec * 100) exceeds 32767 (a BUFR bit limitation).
         BENEFIT: Erroneously large upper-air wind reports will no longer be
                  encoded into the PREPBUFR file.
       - Modified to always encode wind speed obs in m/sec ("SOB") and wind
         direction obs ("DDO") for all types of surface reports (even if one or
         the other are missing but also if both are present). Removed logic
         which encoded "SOB" only for METAR reports when direction was missing
         and speed was .LE. 3 m/sec (direction was never encoded in any
         situation for surface reports). Also removed encoding of "SQM" (wind
         speed quality mark) for these types of METAR reports.  All surface
         reports now encode wind qm as "WQM" regardless of whether or not it
         also encodes direction, speed, u-comp or v-comp {note this change does
         not affect non-surface reports which can still encode speed in knots
         ("FFO") and direction ("DDO") when "UOB" and "VOB" are also encoded.
         (See changes #3 & 7 to fix file prepobs_prep.bufrtable below.)  Other
         minor changes as well.
         BENEFIT: Surface data wind reports that have incomplete wind direction
                  or speed information will now be retained so that at least
                  wind speed (or direction) will be available to the GSI. The
                  GSI (or other downstream processing) will now be able to
                  pull SOB and DDO out of PREPBUFR for all surface reports.
       - For all satellite-derived wind reports, now encodes PREPBUFR report
         sub-type (mnemonic "TSB", previously missing) as BUFR satellite id
         times 10 plus "satellite derived wind computation method ("SWCM" -
         BUFR code table 0-02-023).  (See change #6 to fix file
         prepobs_prep.bufrtable below.)
         BENEFIT: Allows GSI to identify cloud-top vs. deep-layer WV winds and
                  IR vs. visible winds for METEOSAT and JMA since, unlike
                  NESDIS, both have same rpt types (250-JMA & 254-EUMETSAT for
                  WV, 242/252-JMA & 243/253-EUMETSAT for IR/VIS)
       - 1-dim array OBS2 returned from IW3UNPBF increased from 42 to 43 words
         to hold satellite zenith angle (degrees, for all satwnd types),
         encoded into PREPBUFR file (mnemonic "SAZA"). (See changes #1 & 2 to
         fix file prepobs_prep.bufrtable below.)
         BENEFIT: For use by GSI (to possibly screen satwnds with high SAZA
                  values).
       - Changed IRNMRK value for Unrestricted Mesoscale Analysis (URMA)
         network from 9 to 10.
         BENEFIT: Allows URMA to have its own RUN mark value, instead of
                  combining it with the RTMA value of 9.
       - Process new VAD wind reports from level 2 decoder. Do not convert
         winds from dir/speed to u/v these are already u/v and are stored in
         m/sec.
         BENEFIT: VAD wind reports from Level 2 decoder can now be processed
                  and encoded into the PREPBUFR file for use by GSI systems.
       - Differentiate between Radar Coded Message and new Level 2 decoder VAD
         wind reports via use of report subtype (TSB=1 for former and =2 for
         latter).
         BENEFIT: Needed by GSI since both types will be in PREPBUFR file.
       - Increase the maximum number of levels that can be processed (MXLVL)
         from 300 to 600.
         BENEFIT: Allows runs that might include interpolated levels (e.g.,
                  special AFOS graphics, IRNMRK=2) to still work properly as
                  more and more radiosonde levels become available in the new
                  RRS.
       - No longer aborts with RC=99 if number of levels in a report exceeds
         the limit of MXLVL (just updated from 300 to 600, see above)".
         Instead, now skips the offending report(s) and, at the very end, posts
         a message to the joblog file noting how many reports were skipped due
         to this issue.
         BENEFIT: PREP job will not longer stop dead in its tracks in this
                  case. EMC's monitoring utilities will quickly detect this
                  issue since it will be reported in the joblog file.
      iw3unpbf:
   !!! - Added ability to read in and process percent confidence based on
         EUMETSAT Quality Indicator with and without forecast for NESDIS GOES
         winds pulled from NESDIS server (which originally stored them in dump
         file explicitly as "QIFY" and "QIFN" but later stored them both as
         before and as replicated "PCCF" values as with v10 BUFR, and even
         later stored them only as replicated "PCCF" values as with v10 BUFR)
         if they are present.
         (Note: As noted, will also work if these are stored in replicated
                "PCCF" values as with v10 BUFR, e.g., MODIS winds, AVHRR winds,
                JMA winds, EUMETSAT winds.)
   !!! - Added ability to read in and process percent confidence based on
         NESDIS Recursive Filter Function for types which might store it in
         dump file in replicated "PCCF" values as with v10 BUFR (in this case
         NESDIS GOES winds, MODIS winds, AVHRR winds, JMA winds - already in
         place for EUMETSAT winds) if it is present.
         (Note: Will still work if this is stored explicitly as "RFFL" as
                originally with GOES winds pulled from NESDIS server.)
   !!! - Added ability to read in and process percent confidence based on
         NESDIS Expected Error for types which might store it in dump file in
         replicated "PCCF" values as with v10 BUFR (in this case MODIS or AVHRR
         winds) if it is present.
         (Note: Will still work if this is stored explicitly as "EEQF" as
                originally with GOES winds pulled from NESDIS server.
   !!! - Now stores cloud-top/deep-layer indicator in byte 3 of header reserve
         character word 1 for foreign-produced satellite winds (as already done
         for NESDIS-produced satellite winds) - JMA and EUMETSAT imager water
         vapor winds can now be of both types, before they were only cloud-top.
   !!! - Output array OBS2 creased from length 42 to 43 words, where word 43
         contains satellite zenith angle (degrees, satwnd types only)
       - Added new dump report type 534 for surface marine Coast Guard tide
         gauge reports.
         BENEFIT: Now Coast Guard tide gauge reports are available to be
                  encoded into the prepbufr file for all networks that process
                  the SFCSHP dump file.
      w3unpkb7:
   !!! - Modified to handle VAD wind reports from Level 2 decoder (subset
         "NC002017") in addition to those from Radar Coded Message (subset
         "NC002008")}.
   !!! - Parameterized maximum number of levels allowed for each category and
         calculated parameter "IDMAX" (size of output "RDATA" array) based on
         these.  All of these are now placed in new include file
         'inc_w3unpkb7.inc'.
      inc_w3unpkb7.inc:
   !!! - Maximum number of cat. 04 winds-by-height levels (excluding first,
         surface, level) increased from 64 to 254 to account for more levels in
         new VAD wind reports from Level 2 decoder.
   !!! - Maximum number of cat. 11 wind profiler levels (excluding first,
         surface, level) increased from 102 to 200 to account for some MAP
         profilers with more levels than before.
   !!! - The resulting "IDMAX" is now 2270, up from 1200 before.
      gblevents (in w3emc library - version 2.2.0):
       - Added new namelist switch "DOPMSL" which, when TRUE, derives pmsl
         (mnemonic "PMO") from reported station pressure ("POB"), station
         height/elevation ("ZOB") and the just-computed virtual temperature for
         surface reports in cases when pmsl initially encoded in PREPBUFR file
   !!!   by prepobs_prepdata is missing; e.g., for all marine and mesonet
   !!!   reports right now (derivation done in subroutine GBLEVN08).  DOVTMP
         must be TRUE and DOANLS must be FALSE ("PREVENTS" mode). The derived
         pmsl either gets a quality mark ("PMQ") of 3 or inherits the station
         pressure quality mark ("PQM"), whichever is greater. The value of the
         pmsl indicator (new mnemonic "PMIN") is set to 1 to denote pmsl was
         derived rather than observed.  The default for "DOPMSL" is FALSE
         (normally only TRUE in RTMA and URMA runs).  It is forced to be FALSE
         in "POSTEVENTS" mode (DOANLS=TRUE).
         BENEFIT: More complete and thorough pressure information for surface
                  data is available in the RTMA and URMA GSI via this derived
                  pmsl since every report will have a pmsl now (whether
                  observed or derived).  The RTMA/URMA GSI analyzes pmsl.
       - In subroutine GBLEVN02, SFCSHP reports with calm winds and non-missing
         background u- or v-component wind .ge. 5 m/sec are flagged with Q.M. 8
         (event pgm "PREVENT", reason code 8).
         BENEFIT: These data are suspect and will now not be assimilated by any
                  GSI system.

 Fixed file changes:
   prepobs_cqc_statbge, prepobs_landc, syndat_weight:
    - No changes to contents.
   prepobs_prep.bufrtable:
    - 1) Added two new mnemonics to Table B: Satellite Zenith Angle (SAZA),
         Mean Sea-Level Indicator (PMIN).
    - 2) Added SAZA to the Table A SATWND mnemonic sequence.
    - 3) Added existing Table D 1-bit repl. sequence <WSPD_SEQ> to Table A
         SFCSHP and MSONET mnemonic sequences.
    - 4) Added PMIN to PMSL_SEQ mnemonic sequence.
    - 5) Added existing Table D 1-bit repl. sequence <PMSL_SEQ> to Table A
         MSONET mnemonic sequence.
    - 6) Increased Table B mnemonic TSB (Report Subtype) bit width from 10 to
         14.
    - 7) Removed Table B mnemonic SQM (wind speed quality marker).  It had been
         a part of Table D sequence WSPD_SEQ.  It was used only by METAR
         reports with missing direction and speed .LE. 3 m/sec when wind speed
         obs was encoded in SOB.  Since all surface reports now encode SOB, the
         wind quality marker (whether UOB and VOB are reported or not) will
         just be encoded in existing menmonic WQM.
   syndat_syndata.slmask.t126.gaussian:
    - Renamed from syndat_slmask.t126.gaussian to distinguish from file in
      /nwprod/tropcy_qc_reloc.v*/fix
    - No changes to contents.


 Output changes:
 ---------------
!!! significant output changes


 Compute Resource Information:
 -----------------------------
!!!   No changes.


 Preimplementation Testing Requirements:
 ---------------------------------------
   There are no jobs in obsproc_prep.  All jobs executing this version of
   obsproc_prep will be part of the parallel-production test of the OBSPROC 
   Phase 2 bundle.


 Dissemination:
 --------------
   See information about dissemination in the release notes for the obsproc
   networks executing this version of obsproc_prep.


 Special Instructions:
 ---------------------
   This must be implemented simultaneously with the implementations of
   obsproc_global.v2.0.0, obsproc_nam.v2.0.0, obsproc_rap.v2.0.0
   obsproc_rtma.v2.0.0, obsproc_urma.v2.0.0, and ??? (any others?)

   This must be implemented simultaneously with or immediately after the
   w3emc_v2.2.0 implementation.

   Since there are no jobs in obsproc_prep, an obsproc_prep.ver file is not
   needed.

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
